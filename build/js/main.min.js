$(function(){$('[data-toggle="tooltip"]').tooltip()}),function(){"use strict";$.views.settings.delimiters("<%","%>");var e=$("[data-type=chosen]");e.chosen({allow_single_deselect:!0,display_disabled_options:!1}),$(".chosen-results").mouseenter(function(){$(this).find(".group-result").click(function(){var t=$(this),n=t.nextUntil(".group-result"),i=t.closest(".chosen-container-multi").prev().find("optgroup, option");n.each(function(){var e=this.getAttribute("data-option-array-index");i[e].selected=!0}),e.trigger("chosen:updated")})}),document.addEventListener("click",function(e){e.target.matches(".chosen-container .no-results a")&&e.stopPropagation()},!0);var t=$("#search_all");t.typeahead({minLength:2},{displayKey:"name",source:function(e,t){$.get(Routing.generate("search",{q:e}),function(e){t(e)})},templates:{suggestion:function(e){return'<p><i class="fa '+e.icon+'"></i> '+e.name+"</p>"},empty:function(e){return""===e.query?"":'<p class="tt-suggestion">No results found for <strong>'+e.query+"</strong>.</p>"}}}),t.bind("typeahead:selected",function(e,t){location.href=Routing.generate(t.route,{id:t.id})});var n=$("#personAutocomplete"),i=$("#person");n.typeahead({minLength:3},{displayKey:"name",source:function(e,t){$.get(Routing.generate("search",{q:e,type:"person"}),function(e){t(e)})},templates:{suggestion:function(e){return'<p><i class="fa '+e.icon+'"></i> '+e.name+"</p>"},empty:function(e){return""===e.query?'<p class="tt-suggestion">No results found.</p>':'<p class="tt-suggestion">No results found for <strong>'+e.query+"</strong>.</p>"}}}),n.bind("typeahead:selected",function(e,t){i.val(t.id)});var a=$("#participants_search"),o=$("#participants_search_id");if(a.length>0){var r=a.closest("form").data("competition");a.typeahead({minLength:3},{displayKey:"name",source:function(e,t){$.get(Routing.generate("competitions_participants_search",{competition:r,q:e}),function(e){t(e)})},templates:{suggestion:function(e){return"<p>"+e.name+"</p>"},empty:function(e){return""===e.query?'<p class="tt-suggestion">No results found.</p>':'<p class="tt-suggestion">No results found for <strong>'+e.query+"</strong>.</p>"}}}),a.bind("typeahead:selected",function(e,t){o.val(t.id)})}var s=$("[data-unselect]");s.each(function(){var e=$(this),t=$("#"+e.data("unselect"));e.click(function(){t.find("option").attr("selected",!1),t.trigger("chosen:updated")})});var c=$("[data-submit=auto]");c.on("change",function(){this.form.submit()}),$('.order-license-year input[type="radio"]').change(function(){var e=$(this).closest("form"),t={},n=$('.order-license-year input[type="radio"]:checked');t[n.attr("name")]=n.val(),$.ajax({url:e.attr("action"),type:e.attr("method"),data:t,success:function(e){$(".order-license-ajax-target").replaceWith($(e).find(".order-license-ajax-target"))}})})}(),function(e){"use strict";var t=e(".js-bank-infos"),n=e(".js-payment-form input[type=radio]");n.on("change",function(){var n=e(this).val();"2"==n?(t.removeClass("hide"),e("#invoice-price").show(),e("#credit-card-price").hide(),e("#credit-card-tax-add").hide()):(t.addClass("hide"),e("#invoice-price").hide(),e("#credit-card-price").show(),e("#credit-card-tax-add").show())})}(jQuery),function(e){e(".js-modal-file-preview").on("show.bs.modal",function(t){var n=e(t.relatedTarget),i=n.data("download"),a=n.data("title"),o=e(this);o.find(".js-pdf-preview").attr("src",i),o.find(".js-pdf-download").attr("href",i),o.find(".js-pdf-preview-title").text(a)})}(jQuery),function(e){0!==e("#js-pdf-preview").length&&e("#js-pdf-preview").height(e(window).height()-280)}(jQuery);var options={};!function(e){e("#crop-img").cropper({viewMode:1,aspectRatio:5/7}),e("form#crop_image").submit(function(){{var t=e("#crop-img"),n=e(t).data("person"),i=e(t).data("picture");e(t).data("type")}t.cropper("getCroppedCanvas",{width:315,height:440}).toBlob(function(t){var a=new FormData;a.append("croppedImage",t),e.ajax(Routing.generate("person_images_crop_upload",{person:n,picture:i}),{method:"POST",data:a,processData:!1,contentType:!1})})}),e("#person_deceased").change(function(){e("#isDeceased").collapse(e(this).prop("checked")?"show":"hide")})}(jQuery);